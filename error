controlplane:~/Vuln_Prism/kubernetes_deps$ k -n mustang get pods 
NAME                        READY   STATUS    RESTARTS   AGE
cyber-dep-c94b87f5d-4dv99   1/1     Running   0          5m22s
sast-dep-6c6c857c7b-wr8dp   1/1     Running   0          5m21s
vuln-dep-78658698d5-ljm6d   1/1     Running   0          5m22s
controlplane:~/Vuln_Prism/kubernetes_deps$ k -n mustang logs cyber-dep-c94b87f5d-4dv99 -f && k -n mustang logs sast-dep-6c6c857c7b-wr8dp -f 
Could not initialize database tables: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'database-1.c0pogq0w8mxc.us-east-1.rds.amazonaws.com' ([Errno -2] Name or service not known)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-23 08:02:19.509 | ERROR    | app.main:<module>:67 - Failed to connect to Redis: %s. Caching will be disabled.
INFO:     Started server process [1]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:5051 (Press CTRL+C to quit)
INFO:     172.30.2.2:55670 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:51768 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:53084 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:53786 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:60418 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:49626 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:36076 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:55118 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:39922 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:34118 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:41220 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:46668 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:41230 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:42478 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:51326 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:52140 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:42388 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:55098 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:36022 - "GET /health HTTP/1.1" 200 OK
2025-07-23 08:05:36.699 | INFO     | app.main:root:76 - 🌐 Root endpoint accessed - serving index.html directly
INFO:     172.30.2.2:47222 - "GET / HTTP/1.1" 200 OK
INFO:     172.30.2.2:61880 - "GET /static/app.js HTTP/1.1" 200 OK
INFO:     172.30.2.2:31193 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     172.30.2.2:45962 - "GET /health HTTP/1.1" 200 OK
2025-07-23 08:05:47.746 | INFO     | app.main:scan:117 - Starting new scan for target: %s
2025-07-23 08:05:49.490 | INFO     | app.aggressive_scanner.browser_scanner:aggressive_run:113 - Navigating to https://pixabay.com/ for initial analysis.
2025-07-23 08:05:51.418 | INFO     | app.aggressive_scanner.browser_scanner:aggressive_run:122 - Performing static analysis on https://pixabay.com/
INFO:     172.30.2.2:54572 - "GET /health HTTP/1.1" 200 OK
2025-07-23 08:06:00.631 | INFO     | app.aggressive_scanner.browser_scanner:aggressive_run:134 - Starting dynamic form injection for https://pixabay.com/
2025-07-23 08:06:01.302 | INFO     | app.aggressive_scanner.browser_scanner:aggressive_run:140 - Testing input field: search
INFO:     172.30.2.2:42222 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:52872 - "GET /health HTTP/1.1" 200 OK
2025-07-23 08:06:25.722 | ERROR    | app.aggressive_scanner.browser_scanner:aggressive_run:193 - An unexpected error occurred during the browser scan for https://pixabay.com/: 'signature'
Traceback (most recent call last):

  File "/install/bin/uvicorn", line 8, in <module>
    sys.exit(main())
    │   │    └ <Command main>
    │   └ <built-in function exit>
    └ <module 'sys' (built-in)>
  File "/install/lib/python3.11/site-packages/click/core.py", line 1442, in __call__
    return self.main(*args, **kwargs)
           │    │     │       └ {}
           │    │     └ ()
           │    └ <function Command.main at 0x7879dc925da0>
           └ <Command main>
  File "/install/lib/python3.11/site-packages/click/core.py", line 1363, in main
    rv = self.invoke(ctx)
         │    │      └ <click.core.Context object at 0x7879dcb2fa90>
         │    └ <function Command.invoke at 0x7879dc926520>
         └ <Command main>
  File "/install/lib/python3.11/site-packages/click/core.py", line 1226, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           │   │      │    │           │   └ {'host': '0.0.0.0', 'port': 5051, 'app': 'app.main:app', 'uds': None, 'fd': None, 'reload': False, 'reload_dirs': (), 'reload...
           │   │      │    │           └ <click.core.Context object at 0x7879dcb2fa90>
           │   │      │    └ <function main at 0x7879dc8737e0>
           │   │      └ <Command main>
           │   └ <function Context.invoke at 0x7879dc926de0>
           └ <click.core.Context object at 0x7879dcb2fa90>
  File "/install/lib/python3.11/site-packages/click/core.py", line 794, in invoke
    return callback(*args, **kwargs)
           │         │       └ {'host': '0.0.0.0', 'port': 5051, 'app': 'app.main:app', 'uds': None, 'fd': None, 'reload': False, 'reload_dirs': (), 'reload...
           │         └ ()
           └ <function main at 0x7879dc8737e0>
  File "/install/lib/python3.11/site-packages/uvicorn/main.py", line 418, in main
    run(
    └ <function run at 0x7879dc7e20c0>
  File "/install/lib/python3.11/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    │      └ <function Server.run at 0x7879dc7b4900>
    └ <uvicorn.server.Server object at 0x7879dc968fd0>
  File "/install/lib/python3.11/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ None
           │       │   │    └ <function Server.serve at 0x7879dc7b49a0>
           │       │   └ <uvicorn.server.Server object at 0x7879dc968fd0>
           │       └ <function run at 0x7879dd2bc040>
           └ <module 'asyncio' from '/usr/local/lib/python3.11/asyncio/__init__.py'>
  File "/usr/local/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x7879dc81eac0>
           │      └ <function Runner.run at 0x7879dca9fec0>
           └ <asyncio.runners.Runner object at 0x7879dc883590>
  File "/usr/local/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /install/lib/python3.11/site-packages/uvicorn/server.py:82> wait_...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7879dca9db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7879dc883590>
  File "/usr/local/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7879dca9da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7879dca9f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/local/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7879dd259b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/usr/local/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/install/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 404, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7879dc881750>
  File "/install/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
                 │    └ <fastapi.applications.FastAPI object at 0x7879da36b510>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7879dc881750>
  File "/install/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
  File "/install/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7879da3d26d0>
          └ <fastapi.applications.FastAPI object at 0x7879da36b510>
  File "/install/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7879da39df80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x7879da3d2710>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7879da3d26d0>
  File "/install/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '47c74c7e8f5a-10-244-3-31-31727.papa.r.killercoda.com', 'x-forwarded-host': '47c74c7e8f5a-10-244-3-31-31727....
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7879da39df80>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │    └ <function CORSMiddleware.simple_response at 0x7879db988040>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7879da3d2710>
  File "/install/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7879da3d2710>>, ...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7879da3d2750>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x7879da3d2710>
  File "/install/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x7879da3d2710>>, ...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │                            │    │    └ <starlette.requests.Request object at 0x7879da3e61d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7879da38f710>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7879da3d2750>
          └ <function wrap_app_handling_exceptions at 0x7879db8bb420>
  File "/install/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7879da39dda0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          └ <fastapi.routing.APIRouter object at 0x7879da38f710>
  File "/install/lib/python3.11/site-packages/starlette/routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7879da39dda0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7879da38f710>>
          └ <fastapi.routing.APIRouter object at 0x7879da38f710>
  File "/install/lib/python3.11/site-packages/starlette/routing.py", line 782, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7879da39dda0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │     └ <function Route.handle at 0x7879db930b80>
          └ APIRoute(path='/scan', name='scan', methods=['POST'])
  File "/install/lib/python3.11/site-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7879da39dda0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │    └ <function request_response.<locals>.app at 0x7879da39e200>
          └ APIRoute(path='/scan', name='scan', methods=['POST'])
  File "/install/lib/python3.11/site-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7879da39dda0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          │                            │    └ <starlette.requests.Request object at 0x7879da3e40d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7879da39d9e0>
          └ <function wrap_app_handling_exceptions at 0x7879db8bb420>
  File "/install/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7879da422840>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x7879da3e64d0>>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('192.168.1.4', 5051), '...
          └ <function request_response.<locals>.app.<locals>.app at 0x7879da39d9e0>
  File "/install/lib/python3.11/site-packages/starlette/routing.py", line 72, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7879da3e40d0>
                     └ <function get_request_handler.<locals>.app at 0x7879da39e0c0>
  File "/install/lib/python3.11/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7879db8bb240>
  File "/install/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x7879da48f510>, 'request': ScanRequest(url='https://pixabay.com/')}
                 │         └ <function scan at 0x7879da39da80>
                 └ <fastapi.dependencies.models.Dependant object at 0x7879da3d4c10>

  File "/app/app/main.py", line 118, in scan
    findings: ScanResult = await perform_scan(url)
                                 │            └ 'https://pixabay.com/'
                                 └ <function perform_scan at 0x7879db74d1c0>

  File "/app/app/aggressive_scanner/scanner.py", line 58, in perform_scan
    await aggressive_run(url, scan_result)
          │              │    └ <app.aggressive_scanner.scanner.ScanResult object at 0x7879da38f990>
          │              └ 'https://pixabay.com/'
          └ <function aggressive_run at 0x7879d992a7a0>

> File "/app/app/aggressive_scanner/browser_scanner.py", line 160, in aggressive_run
    scan_result.add_vulnerability(url, vuln_type, f"{name} (pre-submit)", payload)
    │           │                 │    │                                  └ '%u003c%u0073%u0076%u0067%u003e%u003c%u0073%u0063%u0072%u0069%u0070%u0074%u003e%u0061%u006c%u0065%u0072%u0074%u0028%u0031%u00...
    │           │                 │    └ 'XSS'
    │           │                 └ 'https://pixabay.com/'
    │           └ <function ScanResult.add_vulnerability at 0x7879db17c720>
    └ <app.aggressive_scanner.scanner.ScanResult object at 0x7879da38f990>

  File "/app/app/aggressive_scanner/scanner.py", line 15, in add_vulnerability
    if not any(v['signature'] == vuln_signature for v in self.vulnerabilities):
                                 │                       │    └ [{'url': 'https://pixabay.com/', 'type': 'Missing Security Headers', 'severity': 'Medium', 'description': 'The following secu...
                                 │                       └ <app.aggressive_scanner.scanner.ScanResult object at 0x7879da38f990>
                                 └ ('https://pixabay.com/', 'XSS', 'search (pre-submit)')

  File "/app/app/aggressive_scanner/scanner.py", line 15, in <genexpr>
    if not any(v['signature'] == vuln_signature for v in self.vulnerabilities):
               │                 │                  └ {'url': 'https://pixabay.com/', 'type': 'Missing Security Headers', 'severity': 'Medium', 'description': 'The following secur...
               │                 └ ('https://pixabay.com/', 'XSS', 'search (pre-submit)')
               └ {'url': 'https://pixabay.com/', 'type': 'Missing Security Headers', 'severity': 'Medium', 'description': 'The following secur...

KeyError: 'signature'
INFO:     172.30.2.2:33174 - "GET /health HTTP/1.1" 200 OK
2025-07-23 08:06:25.904 | ERROR    | app.main:scan:151 - Scan failed for target %s: %s
INFO:     172.30.2.2:64871 - "POST /scan HTTP/1.1" 500 Internal Server Error
INFO:     172.30.2.2:44792 - "GET /health HTTP/1.1" 200 OK
INFO:     172.30.2.2:57834 - "GET /health HTTP/1.1" 200 OK